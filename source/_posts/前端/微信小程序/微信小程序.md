---
title: 微信小程序
date: 2020-10-19 11:15:06
tags:
categories:
fileName:
---

## 小程序全局配置app.json

包括了小程序的所有页面路径、界面表现、网络超时时间、底部 tab 等

写在 `pages` 字段的第一个页面就是这个小程序的首页



### 工具配置 project.config.json

记录开发者工具上的一些个性化配置



### 页面配置 page.json

pages/logs 目录下的 `logs.json` 这类和小程序页面相关的配置



## WXML 模板，小程序中的HTML

通过 {{ }} 的语法把一个变量绑定到界面上，我们称为数据绑定。仅仅通过数据绑定还不够完整的描述状态和界面的关系，还需要 `if`/`else`, `for`等控制能力，在小程序里边，这些控制能力都用 `wx:` 开头的属性来表达。



数据绑定

```
<view hidden="{{flag ? true : false}}">
  if flag == false, hidden: false
</view>
```



```
  data: {
    flag: false
  }
```



列表渲染

```
<view>
  <block wx:for="{{items}}" wx:for-item="item" wx:key="index">
    <view>{{index}}:{{item.name}}</view>
  </block> 
</view>
```







```
data: {
    items: [
      {name: "aaa"},
      {name: "bbb"},
      {name: "ccc"}
    ]
  }
```





条件渲染

模板引用

import	只引入模板（只能引用目标文件中的模板）

include	除模板外的代码都引入



## WXSS 样式，小程序中的CSS

`WXSS` 在底层支持新的尺寸单位 `rpx` ，开发者可以免去换算的烦恼，只要交给小程序底层来换算即可

提供了全局的样式和局部样式。和前边 `app.json`, `page.json` 的概念相同，你可以写一个 `app.wxss` 作为全局样式，会作用于当前小程序的所有页面，局部页面样式 `page.wxss` 仅对当前页面生效



外联样式

```
@import './assets.wxss'
```





## JS

```html
<view>{{ msg }}</view>
<button bindtap="clickMe">点击我</button>
```

点击 `button` 按钮的时候，我们希望把界面上 `msg` 显示成 `"Hello World"`，于是我们在 `button` 上声明一个属性: `bindtap` ，在 JS 文件里边声明了 `clickMe` 方法来响应这次点击操作：

```js
Page({
  clickMe: function() {
    this.setData({ msg: "Hello World" })
  }
})
```



### WXS

WXS（WeiXin Script）是小程序的一套脚本语言，结合 `WXML`，可以构建出页面的结构。



WXML 模板和 WXSS 样式工作在渲染层，JS 脚本工作在逻辑层

小程序的渲染层和逻辑层分别由2个线程管理：渲染层的界面使用了WebView 进行渲染；逻辑层采用JsCore线程运行JS脚本。一个小程序存在多个界面，所以渲染层存在多个WebView线程，这两个线程的通信会经由微信客户端（下文中也会采用Native来代指微信客户端）做中转，逻辑层发送网络请求也经由Native转发，小程序的通信模型下图所示。





在app.json中"pages"中写入页面，会自动生成





多用let、const定义





block	不会进行渲染，相当于一个控制节点







### 组件化开发

在GUI开发领域，组件是一种面向用户的、独立的、可复用的交互元素的封装

高内聚、低耦合、单一职责、避免过多参数





在线制作base64





在组件下对数据进行监听

```
// 对数据进行监听
  observers: {
    ['playlist.playCount'](val) {
      console.log(val)
    }
  },
```



```
wx:for-item="data"	将item名称改为data
wx:for-index="idx"	将index名称改为idx
wx:key="*this"	当前对象本身
wx:key="id"	绑定唯一标识的id属性
```







异步操作：

```
setTimeout(() => {
	console.log(1)
}, 1000)
console.log(2)
// 先输出2
```



```
new Promise((resolve, reject) => {
	setTimeout(() => {
	console.log(1)
	}, 1000)
}).then((res) => {
	setTimeout(() => {
	console.log(1)
	}, 1000)
})
```





callback hell



promise （pending fulfilled rejected）

```

```



